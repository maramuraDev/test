<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Custom Modal for 360 Video</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Barlow:wght@300;400&family=Work+Sans:wght@200&display=swap"
        rel="stylesheet">
    <style>
        /* Styling for the splash screen */
        #splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgb(27, 27, 27);
            background-image: url("./gifs/gradient2.svg");
            display: flex;
            background-size: cover;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }


        h1 {
            width: 80%;
            position: absolute;
            top: 75%;
            text-align: center;
            font-family: 'Work Sans', sans-serif;
            font-weight: lighter;
            color: white;
        }

        /* Styling for the branding content */
        #branding {
            font-size: 24px;
        }

        /* Styling for the custom modal */
        #custom-modal {
            position: relative;
            top: 50%;
            width: 80%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #ffffff82;
            padding: 20px;
            border: .2px solid #cccccc53;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            z-index: 9999;
            text-align: center;
            font-family: 'Barlow', sans-serif;
        }

        #custom-modal h2 {
            font-size: 24px;
            margin-bottom: 10px;
        }

        /* Styling for the custom buttons */
        .custom-button {
            padding: 10px 20px;
            margin: 10px;
            cursor: pointer;
            background-color: rgb(81, 63, 246);
            color: #fff;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-family: 'Barlow', sans-serif;

        }

        .logo-animation {
            position: absolute;
            width: 100%;
            height: 100%;
            top: -30%;
            background-image: url("./gifs/161023_VOLVO_SPLASH1.gif");
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
        }
    </style>
</head>

<body>

    <!-- Splash Screen (HTML overlay) -->
    <div id="splash-screen">
        <div class="logo-animation"></div>

        <!-- Branding content -->
        <h1>Enjoy The Experience</h1>
    </div>

    <!-- Custom modal for user access -->
    <div id="custom-modal">
        <h2>Access to Motion Sensors</h2>
        <p>Please grant access to motion sensors to interact with the 360 video.</p>
        <button class="custom-button" onclick="requestPermission()">Request Access</button>
    </div>

    <a-scene device-orientation-permission-ui="enabled: false" vr-mode-ui="enabled: false">
        <a-assets>
            <!-- 360 video source -->
            <video id="vid" src="360.mp4" muted crossorigin="anonymous"></video>
        </a-assets>

        <a-sky rotation="0 180 0" src="#vid"></a-sky>

        <a-camera look-controls="enabled: false">
            <!-- Use look-controls for camera rotation -->
        </a-camera>
    </a-scene>

    <script>
        window.addEventListener('load', function () {
            // Hide the splash screen when the A-Frame scene is ready
        });

        function requestPermission() {
            if (typeof DeviceOrientationEvent.requestPermission === 'function') {
                DeviceOrientationEvent.requestPermission()
                    .then(function (permissionState) {
                        if (permissionState === 'granted') {
                            var v = document.querySelector('#vid');
                            v.play();
                            var splashScreen = document.getElementById('splash-screen');
                            splashScreen.style.display = 'none';
                            enableCameraControls();
                            closeCustomModal();
                        } else {
                            console.log('Permission denied. You won\'t be able to interact with the 360 video.');
                            // Perform actions on permission denied
                            closeCustomModal();
                        }
                    })
                    .catch(function (error) {
                        console.error(error);
                        closeCustomModal();
                    });
            } else {
                console.log('DeviceOrientationEvent.requestPermission is not supported in this browser.');
            }
        }

        function enableCameraControls() {
            var camera = document.querySelector('a-camera');
            camera.setAttribute('look-controls', 'enabled: true');
        }

        function closeCustomModal() {
            var customModal = document.getElementById('custom-modal');
            customModal.style.display = 'none';
        }
    </script>
</body>

</html>